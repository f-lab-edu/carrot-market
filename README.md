# carrot-market 서비스 개요

- 서비스 설명 : 중고거래 플랫폼 '당근마켓' 을 모티브로 한 중고거래 서비스
- 주요 기능 : 회원가입/로그인, 상품 등록/조회, 거래, 결제, 채팅, 후기, 매너온도 등
- 개요 : 기능 구현보다, 서비스가 성장했을 때의 구조적 선택을 고민하고 검증하는 데 집중한 프로젝트

---

## 프로젝트 중점 사항

본 프로젝트는 중고거래 서비스의 성장 시나리오를 가정하고,  
트래픽 증가 및 도메인 복잡도 확장에 따른 구조적 한계를 고민하는 것을 출발점으로 합니다.

초기 구현 단계에서는 단일 애플리케이션 구조로도 충분하다고 판단하였으나,  
다음과 같은 문제 가능성을 고려하여 서비스 단위 분리를 실험적으로 적용하였습니다.

- 조회 트래픽 집중
- 도메인 책임 증가
- 장애 전파 가능성

그 결과 MSA 아키텍처를 도입하고,  
서비스 간 느슨한 결합을 목표로 시스템을 설계하였습니다.

---

### 이벤트 기반 비동기 통신

검색 인덱싱, 매너온도 계산 등  
즉시 일관성이 필요하지 않은 영역에 대해  
이벤트 기반 비동기 통신을 적용하였습니다.

이를 통해 다음과 같은 효과를 확인하였습니다.

- 서비스 간 결합도 감소
- 실패 격리
- 확장성 측면의 개선

---

### 테스트 전략

아키텍처 및 서비스 간 통신 구조 학습을 주요 목표로 설정하여,  
테스트 코드는 핵심 도메인 로직 중심으로 선택적으로 작성하였습니다.

---

### CI/CD 및 성능 개선

CI/CD 파이프라인을 구축하여  
서비스별 독립 배포 환경을 구성하였습니다.

또한 부하 테스트를 통해 병목 구간을 식별하고,  
설정 및 구조 개선을 반복하며 성능 개선 경험을 축적하였습니다.


---

## 서비스 도메인 구성

본 프로젝트는 초기 단계에서 과도한 분리를 지양하고,  
도메인 책임과 확장 가능성을 고려하여 다음과 같이 6개의 서비스로 구성하였습니다.

---

## 1. User Service (회원 / 인증 / 프로필)

### 책임 데이터
- 사용자 계정
- 인증 정보
- 기본 프로필

### 핵심 기능
- 회원가입(o) / 탈퇴
- 이메일·닉네임 중복 검사(o)
- 비밀번호 암호화(o)
- 로그인(o) / 로그아웃(o)
    - 토큰 검증(o)
    - 블랙리스트 여부 확인(o)
- 기본 정보 조회(My Page)
    - 아래 제외 항목들 Api 조합하여 개발
- 동네 위치 인증 (사용자 주도)

### 제외 항목
- 거래 내역
- 상품 정보
- 커뮤니티 지표 (좋아요, 후기, 매너온도)

---

## 2. Product Service (상품 도메인)

### 책임 데이터
- 상품 기본 정보
- 상품 상태

### 핵심 기능
- 상품 등록 / 수정 / 삭제
- 단건 및 목록 조회
- 상태 관리
    - 판매중 / 예약중 / 숨김 / 거래완료
- 특정 상품 노출 차단 & 해제

### 발행 이벤트
- ProductCreated
- ProductUpdated
- ProductStatusChanged

---

## 3. Search Service (검색 / 조회 전용 Read Model)

### 책임 데이터
- 검색 최적화된 상품 뷰
- 개인화 추천 결과

### 핵심 기능
- 카테고리별 검색 (페이징)
- 키워드 기반 검색 (페이징)
- 필터 / 정렬
- AI 기반 개인화 추천 (페이징)

### 특징
- Product DB 직접 조회하지 않음
- 별도의 Search DB 사용 (예: Elasticsearch)
- Product Service 이벤트 기반 데이터 동기화

---

## 4. Order Service (거래 / 결제)

> Order와 Payment를 하나의 도메인 컨텍스트로 통합

### 책임 데이터
- 거래 정보
- 구매자 / 판매자 관계
- 결제 기록 및 결제 상태

### 핵심 기능
- 거래 생성 및 상태 관리
- 결제 요청 / 승인 / 실패 처리
- 결제 취소 및 환불
- 구매내역 / 판매내역 조회

### 특징
- 외부 PG 연동
- 트랜잭션 안정성 중심 설계
- 핵심 도메인(Core Domain)

---

## 5. Chat Service (채팅)

### 책임 데이터
- 채팅방
- 메시지

### 핵심 기능
- 거래 기반 채팅방 생성
- 실시간 메시지 송수신
- 메시지 조회

### 특징
- WebSocket 기반 실시간 통신
- 메시지 저장용 별도 DB 사용

---

## 6. Community Service (좋아요 / 후기 / 매너온도)

### 책임 데이터
- 사용자 ↔ 상품 관심 관계
- 거래 후기 및 평가 점수
- 사용자별 매너온도

### 핵심 기능
- 좋아요 등록 / 취소
- 좋아요 목록 조회
- 후기 작성 및 조회
    - 거래 완료 여부 검증
- 매너온도 계산 및 조회
    - 신규 후기 기반 배치 처리

### 특징
- 사용자 행동 및 신뢰 지표 성격의 기능을 하나의 컨텍스트로 관리
- 후기 → 매너온도 흐름의 내부 이벤트 처리 가능

---

## 부가요소
- 각 서비스는 명확한 쓰기/읽기 책임을 가지며 이벤트 기반 통신을 권장합니다.
- 검색/추천은 별도 읽기 저장소를 사용하여 조회 성능을 최적화합니다.

---